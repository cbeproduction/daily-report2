<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Daily Production and Dispatch Report</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f6f8; }
  h1, h2 { text-align: center; }
  table { border-collapse: collapse; width: 100%; margin-bottom: 20px; background-color: white; }
  th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
  th { background-color: #2a9df4; color: white; }
  input { width: 90px; text-align: right; padding: 3px; }
  button { padding: 10px 15px; margin: 10px 5px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>

<h1>Daily Production and Dispatch Report</h1>
<h2>Accumulated Status</h2>

<table id="accumulatedStatus">
  <thead>
    <tr>
      <th>SO NO</th>
      <th>Description</th>
      <th colspan="2">SPRING</th>
      <th colspan="2">COIR</th>
      <th>Total</th>
    </tr>
    <tr>
      <th></th><th></th><th>A</th><th>B</th><th>A</th><th>B</th><th></th>
    </tr>
  </thead>
<tbody>
  <tr>
    <td>1</td><td>TOTAL PRODUCTION</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>2</td><td>PRODUCTION</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>3</td><td>TAPE EDGE PRODUCTION</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>4</td><td>PRODUCTION PENDING</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>5</td><td>ABOVE 48HRS PRODUCTION PENDING</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>6</td><td>HOLD</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>7</td><td>PRODUCTION PLAN</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>8</td><td>YESTERDAY MAN POWER</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>

  <tr>
    <td>9</td><td>TODAY MAN POWER</td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number"></td>
    <td><input type="number" readonly></td>
  </tr>
</tbody>
</table>

<h2>Machine Output Status</h2>
<table id="machineOutputStatus">
    <thead>
        <tr>
            <th>SO NO</th>
            <th>Description</th>
            <th colspan="2">SPRING</th>
            <th colspan="2">COIR</th>
            <th>Total</th>
        </tr>
        <tr>
            <th></th><th></th><th>A</th><th>B</th><th>A</th><th>B</th><th></th>
        </tr>
    </thead>
    <tbody>
        <tr><td>1</td><td>QUILTING M/C1</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>2</td><td>QUILTING M/C2</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>3</td><td>BONNEL COILING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>4</td><td>POCKETED COILING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>5</td><td>BONL ASS</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>6</td><td>POCKETED ASS</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>7</td><td>UNIT MAKING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
        <tr><td>8</td><td>PASTING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    </tbody>
</table>

<button onclick="saveReport()">Save Report</button>
<button onclick="printReport()">Print Report</button>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // function to attach listeners and set up totals for each row
  function setupRow(row) {
    // editable inputs = the 4 inputs (SPRING A/B, COIR A/B)
    const editableInputs = Array.from(row.querySelectorAll('td input:not([readonly])'));
    // total input (readonly)
    const totalInput = row.querySelector('td input[readonly]');

    // recalc function for the row
    const recalc = () => {
      const sum = editableInputs.reduce((s, inp) => s + (Number(inp.value) || 0), 0);
      if (totalInput) totalInput.value = sum;
    };

    // attach listeners to editable inputs
    editableInputs.forEach(inp => {
      inp.addEventListener('input', recalc);
      inp.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          // Find all editable inputs in the table in document order
          const allEditable = Array.from(document.querySelectorAll('#accumulatedStatus tbody input:not([readonly])'));
          const idx = allEditable.indexOf(e.target);
          if (idx >= 0) {
            const next = allEditable[idx + 1] || allEditable[0]; // wrap to first if at end
            next.focus();
            next.select?.(); // select text if supported
          }
        }
      });
    });

    // initial calculate
    recalc();
  }

  // setup each existing row
  document.querySelectorAll('#accumulatedStatus tbody tr').forEach(setupRow);

  // OPTIONAL: if rows might be added later dynamically, you can re-run setupRow on the new row.
});

// Save/Print functions (unchanged)
function saveReport() {
  const rows = Array.from(document.querySelectorAll('#accumulatedStatus tbody tr'));
  const data = rows.map(row => Array.from(row.querySelectorAll('td input')).map(i => i.value));
  localStorage.setItem('accumulatedStatus', JSON.stringify(data));
  alert('Report saved!');
}

function printReport() {
  const savedData = JSON.parse(localStorage.getItem('accumulatedStatus')) || [];
  if (!savedData.length) { alert('No report saved!'); return; }

  let html = '<h2>Accumulated Status</h2><table border="1" style="border-collapse:collapse;"><tr><th>SO NO</th><th>Description</th><th>SPRING A</th><th>SPRING B</th><th>COIR A</th><th>COIR B</th><th>Total</th></tr>';
  savedData.forEach(row => html += '<tr>' + row.map(cell => `<td>${cell}</td>`).join('') + '</tr>');
  html += '</table>';

  const win = window.open('', '', 'width=900,height=600');
  win.document.write(html);
  win.document.close();
  win.print();
}
</script>

// Function to setup totals and Enter key navigation for any table
function setupTable(tableId) {
    const table = document.getElementById(tableId);
    table.querySelectorAll('tbody tr').forEach(row => {
        const inputs = Array.from(row.querySelectorAll('td input'));
        const editableInputs = inputs.slice(0, 4); // first 4 inputs editable
        const totalInput = inputs[6]; // last input readonly

        const recalc = () => {
            totalInput.value = editableInputs.reduce((sum, inp) => sum + (Number(inp.value) || 0), 0);
        };

        editableInputs.forEach(inp => {
            inp.addEventListener('input', recalc);
            inp.addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const allInputs = Array.from(document.querySelectorAll('input:not([readonly])'));
                    const idx = allInputs.indexOf(e.target);
                    if (idx >= 0) {
                        const next = allInputs[idx + 1] || allInputs[0]; // wrap to first input if last
                        next.focus();
                        next.select?.();
                    }
                }
            });
        });

        recalc(); // calculate total initially
    });
}

// Initialize both tables
setupTable('accumulatedStatus');
setupTable('machineOutputStatus');

</body>
</html>


