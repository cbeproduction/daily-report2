<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Production and Dispatch Report</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f6f8; }
    h1, h2 { text-align: center; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; background-color: white; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
    th { background-color: #2a9df4; color: white; }
    input { width: 80px; text-align: right; padding: 3px; }
    button { padding: 10px 15px; margin: 10px 5px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>

<h1>Daily Production and Dispatch Report</h1>

<h2>Accumulated Status</h2>
<table id="accumulatedStatus">
    <thead>
        <tr>
            <th>SO NO</th>
            <th>Description</th>
            <th colspan="2">SPRING</th>
            <th colspan="2">COIR</th>
            <th>Total</th>
        </tr>
        <tr>
            <th></th>
            <th></th>
            <th>A</th>
            <th>B</th>
            <th>A</th>
            <th>B</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>TOTAL PRODUCTION</td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number" readonly></td>
        </tr>
        <tr>
            <td>2</td>
            <td>PRODUCTION</td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number" readonly></td>
        </tr>
        <tr>
            <td>3</td>
            <td>TAPE EDGE PRODUCTION</td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number"></td>
            <td><input type="number" readonly></td>
        </tr>
    </tbody>
</table>

<button onclick="saveReport()">Save Report</button>
<button onclick="printReport()">Print Report</button>

<script>
// Attach event listener to all editable inputs
document.querySelectorAll('#accumulatedStatus tbody tr').forEach(row => {
    const inputs = row.querySelectorAll('td input');
    const editableInputs = Array.from(inputs).slice(0, 4); // first 4 are editable
    const totalInput = inputs[4]; // last one is readonly total

    // auto total calculation
    editableInputs.forEach(input => {
        input.addEventListener('input', () => {
            let total = 0;
            editableInputs.forEach(inp => total += Number(inp.value) || 0);
            totalInput.value = total;
        });

        // Enter key navigation
        input.addEventListener('keydown', (e) => {
            if (e.key === "Enter") {
                e.preventDefault(); // stop form submit
                moveToNextInput(input);
            }
        });
    });
});

// Function to move to next input
function moveToNextInput(current) {
    const allInputs = Array.from(document.querySelectorAll('#accumulatedStatus tbody input:not([readonly])'));
    const idx = allInputs.indexOf(current);
    if (idx >= 0 && idx < allInputs.length - 1) {
        allInputs[idx + 1].focus();
    }
}

function saveReport() {
    const table = document.getElementById('accumulatedStatus');
    const data = [];
    table.querySelectorAll('tbody tr').forEach(row => {
        const rowData = [];
        row.querySelectorAll('td input').forEach(input => rowData.push(input.value));
        data.push(rowData);
    });
    localStorage.setItem('accumulatedStatus', JSON.stringify(data));
    alert('Report saved!');
}

function printReport() {
    const savedData = JSON.parse(localStorage.getItem('accumulatedStatus')) || [];
    if (!savedData.length) { alert("No report saved!"); return; }

    let html = '<h2>Accumulated Status</h2><table border="1" style="border-collapse:collapse;"><tr><th>SO NO</th><th>Description</th><th>SPRING A</th><th>SPRING B</th><th>COIR A</th><th>COIR B</th><th>Total</th></tr>';
    savedData.forEach(row => html += '<tr>' + row.map(cell => `<td>${cell}</td>`).join('') + '</tr>');
    html += '</table>';

    const win = window.open('', '', 'width=900,height=600');
    win.document.write(html);
    win.document.close();
    win.print();
}
</script>

</body>
</html>

