<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Daily Production and Dispatch Report</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f6f8; }
h1, h2 { text-align: center; }
table { border-collapse: collapse; width: 100%; margin-bottom: 20px; background-color: white; }
th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
th { background-color: #2a9df4; color: white; }
input { width: 90px; text-align: right; padding: 3px; }
button { padding: 10px 15px; margin: 10px 5px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>

<h1>Daily Production and Dispatch Report</h1>

<h2>Accumulated Status</h2>
<table id="accumulatedStatus">
  <thead>
    <tr><th>SO NO</th><th>Description</th><th colspan="2">SPRING</th><th colspan="2">COIR</th><th>Total</th></tr>
    <tr><th></th><th></th><th>A</th><th>B</th><th>A</th><th>B</th><th></th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>TOTAL PRODUCTION</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>2</td><td>PRODUCTION</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>3</td><td>TAPE EDGE PRODUCTION</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>4</td><td>PRODUCTION PENDING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>5</td><td>ABOVE 48HRS PRODUCTION PENDING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>6</td><td>HOLD</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>7</td><td>PRODUCTION PLAN</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>8</td><td>YESTERDAY MAN POWER</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>9</td><td>TODAY MAN POWER</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
  </tbody>
</table>

<h2>Machine Output Status</h2>
<table id="machineOutputStatus">
  <thead>
    <tr><th>SO NO</th><th>Description</th><th colspan="2">SPRING</th><th colspan="2">COIR</th><th>Total</th></tr>
    <tr><th></th><th></th><th>A</th><th>B</th><th>A</th><th>B</th><th></th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>QUILTING M/C1</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>2</td><td>QUILTING M/C2</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>3</td><td>BONNEL COILING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>4</td><td>POCKETED COILING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>5</td><td>BONL ASS</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>6</td><td>POCKETED ASS</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>7</td><td>UNIT MAKING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
    <tr><td>8</td><td>PASTING</td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number" readonly></td></tr>
  </tbody>
</table>

<button onclick="saveReport()">Save Report</button>
<button onclick="printReport()">Print Report</button>

<script>
document.addEventListener('DOMContentLoaded', () => {
  function setupTable(tableId){
    const table = document.getElementById(tableId);
    table.querySelectorAll('tbody tr').forEach(row=>{
      const editable = Array.from(row.querySelectorAll('input:not([readonly])'));
      const total = row.querySelector('input[readonly]');
      const recalc = ()=> total.value = editable.reduce((sum,i)=>sum + (Number(i.value)||0),0);
      editable.forEach(inp=>{
        inp.addEventListener('input', recalc);
        inp.addEventListener('keydown', e=>{
          if(e.key==='Enter'){
            e.preventDefault();
            const allInputs = Array.from(document.querySelectorAll('input:not([readonly])'));
            const idx = allInputs.indexOf(inp);
            const next = allInputs[idx+1] || allInputs[0];
            next.focus();
            next.select?.();
          }
        });
      });
      recalc();
    });
  }

  setupTable('accumulatedStatus');
  setupTable('machineOutputStatus');

  window.saveReport = ()=>{
    const data = {};
    ['accumulatedStatus','machineOutputStatus'].forEach(id=>{
      const table = document.getElementById(id);
      data[id] = Array.from(table.querySelectorAll('tbody tr')).map(r=>Array.from(r.querySelectorAll('input')).map(i=>i.value));
    });
    localStorage.setItem('dailyReport', JSON.stringify(data));
    alert('Report saved!');
  }

  window.printReport = ()=>{
    const data = JSON.parse(localStorage.getItem('dailyReport')||'{}');
    if(!data.accumulatedStatus && !data.machineOutputStatus){ alert('No report saved!'); return; }
    let html = '<h1>Daily Production and Dispatch Report</h1>';

    if(data.accumulatedStatus){
      html += '<h2>Accumulated Status</h2><table border="1" style="border-collapse:collapse; width:100%">';
      html += '<tr><th>SO NO</th><th>Description</th><th>SPRING A</th><th>SPRING B</th><th>COIR A</th><th>COIR B</th><th>Total</th></tr>';
      data.accumulatedStatus.forEach(row=> html += '<tr>'+row.map(c=>`<td>${c}</td>`).join('')+'</tr>');
      html += '</table>';
    }

    if(data.machineOutputStatus){
      html += '<h2>Machine Output Status</h2><table border="1" style="border-collapse:collapse; width:100%">';
      html += '<tr><th>SO NO</th><th>Description</th><th>SPRING A</th><th>SPRING B</th><th>COIR A</th><th>COIR B</th><th>Total</th></tr>';
      data.machineOutputStatus.forEach(row=> html += '<tr>'+row.map(c=>`<td>${c}</td>`).join('')+'</tr>');
      html += '</table>';
    }

    const win = window.open('','_blank');
    win.document.write(html);
    win.document.close();
    win.print();
  }
});
</script>

</body>
</html>
